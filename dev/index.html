<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · DynamicalCorrelators.jl</title><meta name="title" content="Home · DynamicalCorrelators.jl"/><meta property="og:title" content="Home · DynamicalCorrelators.jl"/><meta property="twitter:title" content="Home · DynamicalCorrelators.jl"/><meta name="description" content="Documentation for DynamicalCorrelators.jl."/><meta property="og:description" content="Documentation for DynamicalCorrelators.jl."/><meta property="twitter:description" content="Documentation for DynamicalCorrelators.jl."/><meta property="og:url" content="https://ZongYongyue.github.io/DynamicalCorrelators.jl/"/><meta property="twitter:url" content="https://ZongYongyue.github.io/DynamicalCorrelators.jl/"/><link rel="canonical" href="https://ZongYongyue.github.io/DynamicalCorrelators.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>DynamicalCorrelators.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Tutorial"><span>Tutorial</span></a></li><li><a class="tocitem" href="#Dynamical-correlation-functions"><span>Dynamical correlation functions</span></a></li><li><a class="tocitem" href="#Note"><span>Note</span></a></li><li><a class="tocitem" href="#Contact"><span>Contact</span></a></li><li><a class="tocitem" href="#Acknowledgments"><span>Acknowledgments</span></a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="tutorials/getting_started/">Getting Started</a></li><li><a class="tocitem" href="tutorials/dmrg/">Ground State with DMRG</a></li><li><a class="tocitem" href="tutorials/dynamical_correlations/">Dynamical Correlations</a></li><li><a class="tocitem" href="tutorials/spectral_functions/">Spectral Functions</a></li><li><a class="tocitem" href="tutorials/finite_temperature/">Finite Temperature</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="api/models/">Models &amp; Lattices</a></li><li><a class="tocitem" href="api/operators/">Operators</a></li><li><a class="tocitem" href="api/states/">States</a></li><li><a class="tocitem" href="api/algorithms/">Algorithms</a></li><li><a class="tocitem" href="api/observables/">Observables</a></li><li><a class="tocitem" href="api/utilities/">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ZongYongyue/DynamicalCorrelators.jl/blob/main/docs/src/index.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>&lt;img src=&quot;./docs/src/logo.png&quot; width=&quot;200&quot;&gt;</p><h1 id="DynamicalCorrelators.jl"><a class="docs-heading-anchor" href="#DynamicalCorrelators.jl">DynamicalCorrelators.jl</a><a id="DynamicalCorrelators.jl-1"></a><a class="docs-heading-anchor-permalink" href="#DynamicalCorrelators.jl" title="Permalink"></a></h1><p><em>A convenient frontend for calculating dynamical correlation functions and related observables based on matrix-product states time evolution methods.</em></p><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><ul><li><p>The symbolic operator representation of a quantum lattice system in condensed matter physics is based on the package <a href="https://github.com/Quantum-Many-Body/QuantumLattices.jl.git"><code>QuantumLattices</code></a></p></li><li><p>The  energy-minimization algorithms like DMRG and the time evolution methods such as TDVP are based on package <a href="https://github.com/QuantumKitHub/MPSKit.jl.git"><code>MPSKit</code></a></p></li><li><p>The bechmark of dynamical correlation functions and related observables is the result from exact diagonalization method based on the packages <a href="https://github.com/Quantum-Many-Body/ExactDiagonalization.jl.git"><code>ExactDiagonalization</code></a></p></li></ul><p>See documents: https://zongyongyue.github.io/DynamicalCorrelators.jl</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>Please type <code>]</code> in the REPL to use the package mode, then type this command:</p><pre><code class="language-julia hljs">add DynamicalCorrelators</code></pre><h2 id="Tutorial"><a class="docs-heading-anchor" href="#Tutorial">Tutorial</a><a id="Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial" title="Permalink"></a></h2><p>Constuct a lattice by <a href="https://github.com/Quantum-Many-Body/QuantumLattices.jl.git"><code>QuantumLattices</code></a>:</p><pre><code class="language-julia hljs">using QuantumLattices
#define the unitcell
unitcell = Lattice([0.0, 0.0]; vectors=[[1/2, √3/2], [1, 0]])
#give the length and width of the lattice and give the boundary condition where &#39;o&#39; is open and &#39;p&#39; is periodic
lattice = Lattice(unitcell, (2, 2), (&#39;o&#39;, &#39;o&#39;))
f = plot(lattice,1; siteon=true)
</code></pre><p>&lt;img  src=&quot;./docs/src/triangularlattice.png&quot;  width=&quot;400&quot;  align=&quot;center&quot; /&gt;</p><p>With the help of <a href="https://github.com/Quantum-Many-Body/QuantumLattices.jl.git"><code>QuantumLattices</code></a>, constructing the lattice of a realistic system allows for the convenient inclusion of terms in the Hamiltonian for arbitrary neighbors, without the need to construct different types of lattices and define their neighbor relations case by case:</p><pre><code class="language-julia hljs">using TensorKit
using MPSKit
using DynamicalCorrelators
using Plots
#define the hilbert space
hilbert = Hilbert(site=&gt;Fock{:f}(1, 2) for site=1:length(lattice))

#give the terms in the Hamiltonian
t = Hopping(:t, -1.0, 1)
U = Hubbard(:U, 8.0)

#construct the Hamiltonian
H = hamiltonian((t, U), lattice, hilbert; neighbors=1)</code></pre><p>Here, <span>$hamiltonian$</span> returns a <span>$MPOHamiltonian$</span> type data that can be directly used in the algorithms like DMRG in <a href="https://github.com/QuantumKitHub/MPSKit.jl.git"><code>MPSKit</code></a>:</p><pre><code class="language-julia hljs">#give the filling = (a, b) -&gt; filling = a/b
filling = (1, 1)

#find the ground state and ground energy
st = randFiniteMPS(Float64, U1Irrep, U1Irrep, length(lattice); filling=filling)
gs, envs, delta = find_groundstate(st, H, DMRG2(trscheme= trunctol(1e-9)));
E0 = expectation_value(gs, H)</code></pre><p>It should be noted that currently, this construction method is only supported for Hamiltonians with Abelian symmetries. For Hamiltonians with non-Abelian symmetries, the construction still needs to follow the method used in <a href="https://github.com/QuantumKitHub/MPSKitModels.jl"><code>MPSKitModels</code></a>.</p><p>Next, let&#39;s look at how to calculate correlation functions. Here, I consider SU(2) symmetry, so I use the pre-defined <code>MPOHamiltonian</code> in the <code>models</code> file. If only U(1) symmetry is considered, using the method described above to obtain the <code>MPOHamiltonian</code> provides greater flexibility.</p><pre><code class="language-julia hljs">using TensorKit
using MPSKit
using MPSKitModels: FiniteChain
using DynamicalCorrelators

# give filling = (a,b), where a=b is half-filling, a&lt;b is h-doping and a&gt;b is e-doping
filling = (1,1)

# give a hamiltonian
N = 4
H = hubbard(Float64, SU2Irrep, U1Irrep, FiniteChain(N); filling=filling, t=1, U=8, μ=0)

# give a N-site random initial state
st = randFiniteMPS(ComplexF64, SU2Irrep, U1Irrep, N; filling=filling)

#find the ground state |gs&gt;
gs, envs, delta = find_groundstate(st, H, DMRG2(trscheme= trunctol(1e-6)));

#obtain c^†_1|gs&gt; and c^†_4|gs&gt;
ep =  e_plus(Float64, SU2Irrep, U1Irrep; side=:L, filling=filling)
i, j = 1, 4
cgs₁ = chargedMPS(ep, gs, i)
cgs₂ = chargedMPS(ep, gs, j)


#give the creation and annihilation operators
cp =  e_plus(Float64, SU2Irrep, U1Irrep; side=:L, filling=filling)
cm =  e_min(Float64, SU2Irrep, U1Irrep; side=:L, filling=filling)
sp =  S_plus(Float64, SU2Irrep, U1Irrep; filling=filling)

#calculate the dynamical single-particle correlation function
edc = dcorrelator(gs, H, (cp, cm); trscheme=truncrank(200), n=n, dt=dt, ft=ft)

#calculate the dynamical two-particle spin-spin correlation function
sdc = dcorrelator(gs, H, sp, 1:48; trscheme=truncrank(200), n=n, dt=dt, ft=ft)</code></pre><p>After Fourier transform with <code>fourier_kw</code>, we can obtain their spectral functions:</p><p>&lt;img  src=&quot;./docs/src/electron_spectrum.png&quot;  width=&quot;600&quot;  align=&quot;center&quot; /&gt;</p><p>for the electron spectrum, and</p><p>&lt;img  src=&quot;./docs/src/spin_spectrum.png&quot;  width=&quot;600&quot;  align=&quot;center&quot; /&gt;</p><p>for the spin-spin spectrum.</p><h2 id="Dynamical-correlation-functions"><a class="docs-heading-anchor" href="#Dynamical-correlation-functions">Dynamical correlation functions</a><a id="Dynamical-correlation-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Dynamical-correlation-functions" title="Permalink"></a></h2><h3 id="Discrete-space-and-time-Fourier-transforms"><a class="docs-heading-anchor" href="#Discrete-space-and-time-Fourier-transforms">Discrete space and time Fourier transforms</a><a id="Discrete-space-and-time-Fourier-transforms-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-space-and-time-Fourier-transforms" title="Permalink"></a></h3><p>If the <span>$x$</span> variable has only discrete values (<span>$x=na$</span>, for <span>$n=1,2,3,...,N$</span>) and finite length <span>$L$</span> (<span>$L=Na$</span>), the expansion of the function is</p><p class="math-container">\[f_n=\sum_{m=1}^{N} A_{q} e^{iq_m x_n},\quad q=\frac{2\pi}{L}m,\]</p><p>where</p><p class="math-container">\[A_{q}=\frac{1}{N}\sum^N_{n=1}f_n e^{-iq_mx_n}. $$

Dividing $A_{q}$ by the mode $\frac{2\pi}{L}$, the Fourier amplitudes with a per unit spacial interval is

$$ A(q) = \frac{L}{2\pi}A_q=\frac{a}{2\pi}\sum^N_{n=1}f_ne^{-iqx_n}.\]</p><p>If the times <span>$t$</span> are discrete times (<span>$t=l\Delta t$</span>, for <span>$l=0,1,2,...,N$</span>) and the final evolutionary time <span>$t_{\mathrm{end}}=N\Delta t$</span>, the expansion of the function is</p><p>$</p><p>f<em>l=\sum</em>{p=1}^N A<em>{\omega} e^{-i\omega</em>p t<em>l},\quad \omega=\frac{2\pi}{t</em>{\mathrm{end}}}p,$</p><p>where</p><p class="math-container">\[A_{\omega}=\frac{1}{N}\sum_{l=1}^N f_l e^{i\omega_p t_l}.\]</p><p>To make it a per unit frequency interval, one need to divide by the spacing of the discrete frequency mode and the Fourier amlitudes are given by,</p><p class="math-container">\[A(\omega)=\frac{t_{\mathrm{end}}}{2\pi}A_{\omega}=\frac{\Delta t}{2\pi}\sum_{l=1}^N f_l e^{i\omega t_l}.\]</p><p>Although a Fourier series is designed to represent functions that are periodic, one can assume that the finite data sequence can be periodically repeated, which leads to the time at index <span>$l=N$</span> is identified with the time at <span>$l=0$</span>. However, the small errors made at the end of a period will be irrelevant as long as the primary correlations decay in less time than <span>$t_{\mathrm{end}}$</span>.</p><h3 id="Space-and-time-correlations"><a class="docs-heading-anchor" href="#Space-and-time-correlations">Space and time correlations</a><a id="Space-and-time-correlations-1"></a><a class="docs-heading-anchor-permalink" href="#Space-and-time-correlations" title="Permalink"></a></h3><p>By use of double Fourier transforms, one can obtain the <span>$k-\omega$</span> space correlation function <span>$G(k,\omega)$</span>,</p><p class="math-container">\[G(k,\omega)=\frac{1}{(2\pi)^2}\Delta t\sum_{l=1}^{N_t} a\sum_{n=1}^{N_L} G(x, t) e^{-i(kx-\omega t)}.\]</p><p>With</p><p class="math-container">\[\Delta t \sum_{l=1}^{N_t}\to \int_0^{t_{\mathrm{end}}}dt,\quad a\sum_{n=1}^{N_L}\to \int_0^L dx,\]</p><p>the continuous form is as follows</p><p>$</p><p>G(k,\omega) = \frac{1}{(2\pi)^2} \int<em>0^{t</em>{\mathrm{end}}}dt \int_0^L dx G(x, t) e^{-i(kx-\omega t)}. $</p><p>The real-space and real-time correlation function <span>$G(x, t)$</span> is given by,</p><p>$</p><p>\begin{aligned}G\left( x<em>{n},t\right) &amp;=\frac{1}{N</em>t}\sum<em>{l=1}^{N</em>t}\frac{1}{N<em>{L}}\sum</em>{m=1}^{N<em>{L}}\langle 0 | C\left( x</em>{m}+x<em>{n},t</em>{l}+t\right) C^{\dagger}\left( x<em>{m},t</em>{l}\right) | 0\rangle \
&amp;=\frac{1}{N<em>t}\sum</em>{l=1}^{N<em>t}\frac{1}{N</em>{L}}\sum<em>{m=1}^{N</em>L}\langle 0| e^{iH(t<em>{l}+t)}C\left( x</em>{m}+x<em>{n}\right) e^{-iH(t</em>l+t) }e^{iHt<em>{l}}C^{\dagger}\left( x</em>{m}\right) e^{-iHt<em>{l}}| 0\rangle \
&amp;=\frac{1}{N</em>{L}}\sum<em>{m=1}^{N</em>{L}}e^{iE<em>{0}t}\langle 0| C\left( x</em>{m}+x<em>{n}\right) e^{-iHt}C^{\dagger}\left( x</em>{m}\right) | 0\rangle. \end{aligned}$</p><p>Finally, one gets,</p><p>$</p><p>G(k,\omega)=\frac{1}{(2\pi)^2}\Delta t\sum<em>{l=1}^{N</em>t} a\sum<em>{n=1}^{N</em>L} \frac{1}{N<em>{L}}\sum</em>{m=1}^{N<em>{L}}e^{iE</em>{0}t}\langle 0| C\left( x<em>{m}+x</em>{n}\right) e^{-iHt}C^{\dagger}\left( x<em>{m}\right) | 0\rangle e^{-i(kx</em>n-\omega t)}. $</p><p>Here, the matrix-product states time evolution methods are implemented to solve the state <span>$e^{-iHt}C^{\dagger}\left( x_{m}\right) | 0\rangle$</span>.</p><h3 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h3><ul><li><p>Wysin G M. Magnetic Excitations and Geometric Confinement[M]. Philadelphia, USA: IOP, 2015.</p></li><li><p>Paeckel S, Köhler T, Swoboda A, et al. Time-evolution methods for matrix-product states[J]. Annals of Physics, 2019, 411: 167998.</p></li></ul><h2 id="Note"><a class="docs-heading-anchor" href="#Note">Note</a><a id="Note-1"></a><a class="docs-heading-anchor-permalink" href="#Note" title="Permalink"></a></h2><p>Due to the fast development of this package, releases with different minor version numbers are <strong>not</strong> guaranteed to be compatible with previous ones <strong>before</strong> the release of v1.0.0. Comments are welcomed in the issues.</p><h2 id="Contact"><a class="docs-heading-anchor" href="#Contact">Contact</a><a id="Contact-1"></a><a class="docs-heading-anchor-permalink" href="#Contact" title="Permalink"></a></h2><p>Y.-Y.Zong: zongyongyue@gmail.com</p><h2 id="Acknowledgments"><a class="docs-heading-anchor" href="#Acknowledgments">Acknowledgments</a><a id="Acknowledgments-1"></a><a class="docs-heading-anchor-permalink" href="#Acknowledgments" title="Permalink"></a></h2><p>We thank Maartenvd, lkdvos for help discussions, and thank Zhao-Long Gu for great help.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="tutorials/getting_started/">Getting Started »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 8 February 2026 18:13">Sunday 8 February 2026</span>. Using Julia version 1.11.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
